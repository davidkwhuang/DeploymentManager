<?xml version="1.0" encoding="UTF-8"?>
<database>
    <element attributes="email_client=true" audit="true" label="Deployment" max_length="40" name="x_dptmgr_deployment" type="collection">
        <element calculation="(function calculatedFieldValue(current) {&#13;&#10;&#13;&#10;&#9;// Add your code here&#13;&#10;&#9;return '';  // return the calculated value&#13;&#10;&#13;&#10;})(current);" label="Change Reference" max_length="32" name="change_reference" reference="change_request" type="reference"/>
        <element calculation="(function calculatedFieldValue(current) {&#13;&#10;&#13;&#10;&#9;// Add your code here&#13;&#10;&#9;return '';  // return the calculated value&#13;&#10;&#13;&#10;})(current);" label="Current Release" max_length="40" name="current_release" type="boolean"/>
        <element calculation="(function calculatedFieldValue(current) {&#13;&#10;&#13;&#10;&#9;// Add your code here&#13;&#10;&#9;return '';  // return the calculated value&#13;&#10;&#13;&#10;})(current);" label="Deployment Notes" max_length="4000" name="deployment_notes" type="journal"/>
        <element calculation="(function calculatedFieldValue(current) {&#13;&#10;var count = new GlideAggregate('x_dptmgr_deployment_plan');&#13;&#10;count.addQuery('associated_deployment.sys_id', current.sys_id);&#13;&#10;count.addEncodedQuery('task_status=Complete');&#13;&#10;count.addAggregate('COUNT');&#13;&#10;count.query();&#13;&#10;var totalsteps = 0;&#13;&#10;if(count.next()) &#13;&#10;   totalsteps = count.getAggregate('COUNT');&#13;&#10;&#13;&#10;&#9;return totalsteps;  // return the calculated value&#13;&#10;&#13;&#10;})(current);" label="Deployment Steps Completed" max_length="40" name="deployment_steps_completed" type="integer" virtual="true"/>
        <element calculation="(function calculatedFieldValue(current) {&#13;&#10;&#13;&#10;&#9;// Add your code here&#13;&#10;&#9;return '';  // return the calculated value&#13;&#10;&#13;&#10;})(current);" label="Engineering Impersonator Access" max_length="4000" name="engineering_impersonator_access" reference="sys_user" reference_qual="active=true^EQ" reference_qual_condition="active=true^EQ" type="glide_list"/>
        <element calculation="(function calculatedFieldValue(current) {&#13;&#10;&#13;&#10;&#9;// Add your code here&#13;&#10;&#9;return '';  // return the calculated value&#13;&#10;&#13;&#10;})(current);" label="Engineering Validation Start Time" max_length="40" name="engineering_validation_start_time" type="glide_date_time"/>
        <element calculation="(function calculatedFieldValue(current) {&#13;&#10;&#13;&#10;&#9;// Add your code here&#13;&#10;&#9;return '';  // return the calculated value&#13;&#10;&#13;&#10;})(current);" label="Estimated Deployment Completion" max_length="40" name="estimated_deployment_completion" type="glide_date_time"/>
        <element calculation="(function calculatedFieldValue(current) {&#13;&#10;&#13;&#10;var start = new GlideDateTime(current.planned_start_time.getDisplayValue());&#13;&#10;var end = new GlideDateTime(current.estimated_deployment_completion.getDisplayValue());&#13;&#10;var dur = GlideDateTime.subtract(start, end); //the difference between start and end&#13;&#10;&#13;&#10;return dur;  // return the calculated value&#13;&#10;&#13;&#10;})(current);" label="Estimated Deployment Duration" max_length="40" name="estimated_deployment_duration" type="glide_duration" virtual="true"/>
        <element calculation="(function calculatedFieldValue(current) {&#13;&#10;&#13;&#10;&#9;// Add your code here&#13;&#10;&#9;return '';  // return the calculated value&#13;&#10;&#13;&#10;})(current);" label="Expected Time Left (Mins)" max_length="40" name="expected_time_left" type="integer"/>
        <element calculation="(function calculatedFieldValue(current) {&#13;&#10;&#13;&#10;&#9;// Add your code here&#13;&#10;&#9;return '';  // return the calculated value&#13;&#10;&#13;&#10;})(current);" label="Testing Impersonator Access" max_length="4000" name="impersonator_access" reference="sys_user" reference_qual="active=true^EQ" reference_qual_condition="active=true^EQ" type="glide_list"/>
        <element calculation="(function calculatedFieldValue(current) {&#13;&#10;&#13;&#10;&#9;// Add your code here&#13;&#10;&#9;return '';  // return the calculated value&#13;&#10;&#13;&#10;})(current);" label="Key Contacts" max_length="10000" name="key_contacts" type="string"/>
        <element attributes="ignore_filter_on_new=true" default="javascript:global.getNextObjNumberPadded();" label="Number" max_length="40" name="number" read_only="true" type="string"/>
        <element calculation="(function calculatedFieldValue(current) {&#13;&#10;&#13;&#10;var progress = current.deployment_steps_completed;&#13;&#10;var total = current.total_deployment_steps;&#13;&#10;var complete = (progress / total ) * 100;&#13;&#10;&#9;return complete;  // return the calculated value&#13;&#10;&#13;&#10;})(current);" label="Percentage of Deployment Complete" max_length="40" name="percentage_of_deployment_complete" type="percent_complete" virtual="true"/>
        <element calculation="(function calculatedFieldValue(current) {&#13;&#10;&#13;&#10;&#9;// Add your code here&#13;&#10;&#9;return '';  // return the calculated value&#13;&#10;&#13;&#10;})(current);" label="Planned Start Time" max_length="40" name="planned_start_time" type="glide_date_time"/>
        <element calculation="(function calculatedFieldValue(current) {&#13;&#10;&#13;&#10;&#9;// Add your code here&#13;&#10;&#9;return '';  // return the calculated value&#13;&#10;&#13;&#10;})(current);" label="Read Only Admin Access" max_length="1000" name="read_only_admin_access" reference="sys_user" reference_qual="active=true^EQ" reference_qual_condition="active=true^EQ" type="glide_list"/>
        <element calculation="(function calculatedFieldValue(current) {&#13;&#10;&#13;&#10;&#9;// Add your code here&#13;&#10;&#9;return '';  // return the calculated value&#13;&#10;&#13;&#10;})(current);" label="Release Date" max_length="40" name="release_date" type="glide_date_time"/>
        <element calculation="(function calculatedFieldValue(current) {&#13;&#10;&#13;&#10;&#9;// Add your code here&#13;&#10;&#9;return '';  // return the calculated value&#13;&#10;&#13;&#10;})(current);" label="Release Description" max_length="10000" name="release_description" type="string"/>
        <element calculation="(function calculatedFieldValue(current) {&#13;&#10;&#13;&#10;&#9;// Add your code here&#13;&#10;&#9;return '';  // return the calculated value&#13;&#10;&#13;&#10;})(current);" display="true" label="Release Name" mandatory="true" max_length="80" name="release_name" type="string"/>
        <element calculation="(function calculatedFieldValue(current) {&#13;&#10;&#13;&#10;&#9;// Add your code here&#13;&#10;&#9;return '';  // return the calculated value&#13;&#10;&#13;&#10;})(current);" label="Release Signed Off" max_length="40" name="release_signed_off" type="glide_date_time"/>
        <element calculation="(function calculatedFieldValue(current) {&#13;&#10;&#13;&#10;&#9;// Add your code here&#13;&#10;&#9;return '';  // return the calculated value&#13;&#10;&#13;&#10;})(current);" label="SIT End" max_length="40" name="sit_end" type="glide_date"/>
        <element calculation="(function calculatedFieldValue(current) {&#13;&#10;&#13;&#10;&#9;// Add your code here&#13;&#10;&#9;return '';  // return the calculated value&#13;&#10;&#13;&#10;})(current);" label="SIT Start" max_length="40" name="sit_start" type="glide_date"/>
        <element calculation="(function calculatedFieldValue(current) {&#13;&#10;&#13;&#10;&#9;// Add your code here&#13;&#10;&#9;return '';  // return the calculated value&#13;&#10;&#13;&#10;})(current);" choice="1" label="State" max_length="40" name="state" type="choice">
            <choice>
                <element label="Open" sequence="10" value="Open"/>
                <element label="Development" sequence="20" value="Development"/>
                <element label="SIT" sequence="30" value="SIT"/>
                <element label="UAT" sequence="40" value="UAT"/>
                <element label="Regression" sequence="50" value="Regression"/>
                <element label="Dress Rehearsal" sequence="60" value="Dress Rehearsal"/>
                <element label="Release" sequence="70" value="Release"/>
                <element label="Closed" sequence="80" value="Closed"/>
            </choice>
        </element>
        <element calculation="(function calculatedFieldValue(current) {&#13;&#10;&#13;&#10;&#9;// Add your code here&#13;&#10;&#9;return '';  // return the calculated value&#13;&#10;&#13;&#10;})(current);" label="Production Validation" max_length="40" name="testing_start_time" type="glide_date_time"/>
        <element calculation="(function calculatedFieldValue(current) {&#13;&#10;var count = new GlideAggregate('x_dptmgr_deployment_plan');&#13;&#10;count.addQuery('associated_deployment.sys_id', current.sys_id);&#13;&#10;count.addAggregate('COUNT');&#13;&#10;count.query();&#13;&#10;var totalsteps = 0;&#13;&#10;if(count.next()) &#13;&#10;   totalsteps = count.getAggregate('COUNT');&#13;&#10;&#13;&#10;&#9;return totalsteps;  // return the calculated value&#13;&#10;&#13;&#10;})(current);" label="Total Deployment Steps" max_length="40" name="total_deployment_steps" type="integer" virtual="true"/>
        <element calculation="(function calculatedFieldValue(current) {&#13;&#10;&#13;&#10;&#9;// Add your code here&#13;&#10;&#9;return '';  // return the calculated value&#13;&#10;&#13;&#10;})(current);" label="UAT End" max_length="40" name="uat_end" type="glide_date"/>
        <element calculation="(function calculatedFieldValue(current) {&#13;&#10;&#13;&#10;&#9;// Add your code here&#13;&#10;&#9;return '';  // return the calculated value&#13;&#10;&#13;&#10;})(current);" label="UAT Start" max_length="40" name="uat_start" type="glide_date"/>
        <element calculation="(function calculatedFieldValue(current) {&#13;&#10;&#13;&#10;var count = new GlideRecord('x_dptmgr_deployment_plan');&#13;&#10;count.addQuery('associated_deployment.sys_id', current.sys_id);&#13;&#10;count.addEncodedQuery('task_status=Complete');&#13;&#10;count.query();&#13;&#10;var weightpercent = 0;&#13;&#10;while(count.next()) {&#13;&#10;   weightpercent = weightpercent + count.weight;&#13;&#10;}&#13;&#10;&#9;return weightpercent;  // return the calculated value&#13;&#10;&#13;&#10;})(current);" label="Weighted Completion Percentage" max_length="40" name="weighted_completion_percentage" type="percent_complete" virtual="true"/>
        <index name="index">
            <element name="change_reference"/>
        </index>
    </element>
</database>
